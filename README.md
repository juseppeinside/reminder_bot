# Telegram Notification Bot

Телеграм-бот для отправки регулярных уведомлений по расписанию.

## Функциональность

- Создание ежедневных уведомлений, которые будут отправляться в указанное время каждый день
- Создание ежемесячных уведомлений, которые будут отправляться в указанную дату каждого месяца
- Возможность задать несколько временных точек для отправки одного сообщения
- Настройка периода отправки уведомлений (количество дней/месяцев или бесконечно)
- Удаление уведомлений по их уникальному идентификатору
- Просмотр списка активных уведомлений

## Установка и запуск

1. Клонируйте репозиторий:

```
git clone https://github.com/yourusername/telegram-notification-bot.git
cd telegram-notification-bot
```

2. Установите зависимости:

```
npm install
```

3. Создайте файл `.env` в корневой директории проекта и укажите токен вашего Telegram бота:

```
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
```

4. Запустите бота:

```
npm start
```

## Настройка ИИ ассистента (GigaChat)

Для использования команды `/ai` с ИИ ассистентом GigaChat необходимо:

1. Зарегистрироваться на платформе [GigaChat](https://developers.sber.ru/portal/products/gigachat-api) от Сбера.
2. Получить учетные данные в личном кабинете:

   - Перейдите в раздел GigaChat API
   - Нажмите "Попробовать" и пройдите регистрацию
   - После входа в личный кабинет перейдите в раздел "Документация API" (API Docs)
   - В разделе авторизации найдите Client ID и Client Secret
   - Скопируйте полученные данные

3. Создайте файл `.env` в корне проекта и добавьте строки:

```
GIGACHAT_CLIENT_ID=ваш_client_id
GIGACHAT_CLIENT_SECRET=ваш_client_secret
GIGACHAT_SCOPE=GIGACHAT_API_PERS
```

4. Установите дополнительные зависимости (если еще не установлены):

```
npm install axios uuid
```

5. Перезапустите бота для применения изменений.

### Использование ИИ ассистента

Отправьте боту команду:

```
/ai текст вашего сообщения
```

Например:

```
/ai Напиши короткое стихотворение о зиме
```

GigaChat обработает ваш запрос и пришлет ответ.

**Примечание:** GigaChat API предоставляет бесплатный лимит токенов (около 1 миллиона) в год. Это дает возможность обрабатывать большое количество текстовых запросов без дополнительной оплаты. После исчерпания бесплатного лимита можно приобрести дополнительные токены.

## Использование

### Создание ежедневного уведомления

Отправьте сообщение боту в одном из следующих форматов:

1. Время в кавычках (можно указать несколько через запятую):

```
"Текст сообщения" "ЧЧ:ММ,ЧЧ:ММ" КОЛ-ВО_ДНЕЙ
```

```
«Текст сообщения» «ЧЧ:ММ,ЧЧ:ММ» КОЛ-ВО_ДНЕЙ
```

2. Время без кавычек (только одно время):

```
"Текст сообщения" ЧЧ:ММ КОЛ-ВО_ДНЕЙ
```

```
«Текст сообщения» ЧЧ:ММ КОЛ-ВО_ДНЕЙ
```

Где:

- `Текст сообщения` - текст, который будет отправляться вам в качестве уведомления
- `ЧЧ:ММ` - время отправки уведомлений
- `КОЛ-ВО_ДНЕЙ` - количество дней, в течение которых будет отправляться уведомление, или ключевое слово `infinity` для бесконечной отправки

### Создание ежемесячного уведомления

Отправьте команду `/month` боту в одном из следующих форматов:

1. Время в кавычках (можно указать несколько через запятую):

```
/month "Текст сообщения" "ЧЧ:ММ,ЧЧ:ММ" КОЛ-ВО_МЕСЯЦЕВ ДЕНЬ_МЕСЯЦА
```

```
/month «Текст сообщения» «ЧЧ:ММ,ЧЧ:ММ» КОЛ-ВО_МЕСЯЦЕВ ДЕНЬ_МЕСЯЦА
```

2. Время без кавычек (только одно время):

```
/month "Текст сообщения" ЧЧ:ММ КОЛ-ВО_МЕСЯЦЕВ ДЕНЬ_МЕСЯЦА
```

```
/month «Текст сообщения» ЧЧ:ММ КОЛ-ВО_МЕСЯЦЕВ ДЕНЬ_МЕСЯЦА
```

Где:

- `Текст сообщения` - текст, который будет отправляться вам в качестве уведомления
- `ЧЧ:ММ` - время отправки уведомлений
- `КОЛ-ВО_МЕСЯЦЕВ` - количество месяцев, в течение которых будет отправляться уведомление, или ключевое слово `infinity` для бесконечной отправки
- `ДЕНЬ_МЕСЯЦА` - день месяца (число от 1 до 28), в который будет отправляться уведомление

### Примеры

Ежедневные уведомления:

```
"Выпить воды" "12:00,16:00" 30
```

```
«Выпить воды» «12:00,16:00» 30
```

```
"Выпить воды" 12:00 30
```

```
«Выпить воды» 12:00 infinity
```

Ежемесячные уведомления:

```
/month "Оплатить счета" 10:00 12 15
```

```
/month "Поздравить маму" "10:00,12:00" infinity 3
```

После успешного создания уведомления бот вернет сообщение:

```
Принято UUID: {UUID}
```

### Удаление уведомления

Для удаления уведомления используйте команду:

```
/delete UUID
```

Где `UUID` - уникальный идентификатор уведомления, полученный при его создании.

### Список команд

- `/start` - Начать работу с ботом и получить инструкции
- `/help` - Получить справку по использованию бота
- `/list` - Просмотреть список ваших активных уведомлений
- `/month` - Создать ежемесячное уведомление

## Структура проекта

- `src/index.js` - Главный файл бота
- `src/db.js` - Работа с базой данных SQLite
- `src/scheduler.js` - Планировщик отправки уведомлений
- `src/utils.js` - Утилиты для парсинга и валидации сообщений
- `config.js` - Файл конфигурации

## Примечания

- Бот использует московское время (UTC+3) для отправки уведомлений
- Для хранения данных используется SQLite база данных
- Уведомления, срок действия которых истек, автоматически удаляются из базы данных
- Бесконечные уведомления (созданные с параметром `infinity`) можно остановить только вручную, используя команду `/delete`
- Ежемесячные уведомления можно создавать только с числом месяца от 1 до 28, чтобы избежать проблем с месяцами разной длины
